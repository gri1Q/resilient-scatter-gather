Тестовое задание: "Resilient Scatter-Gather"


Требования: Вы пишете HTTP-хендлер для API Gateway. Клиент запрашивает "Сводку по чату". Чтобы собрать ответ, нужно одновременно сходить в 3 микросервиса (симулируем их моками/функциями с time.Sleep):

1. UserService (getUser): Критичный. Отвечает быстро (10ms). Если упал — 500 ошибка.
2. VectorMemory (getContext): Тяжелый, нестабильный. Может отвечать 100ms, может 3 секунды, может упасть. Не критичный (если не ответил/упал — отдаем ответ без него).
3. PermissionsService (checkAccess): Критичный. Отвечает 50ms.

Задача: Реализовать хендлер, который:
1. Запускает запросы параллельно (Fan-out).
2. Имеет жесткий SLA на ответ клиенту: 200 мс.
3. Degradation Strategy: Если VectorMemory не успел за 200мс — мы его отрубаем, но возвращаем клиенту 200 OK с данными от User и Permissions.
4. Если критичный сервис (User или Permissions) упал или не успел — возвращаем 500.



**
GET запросы
localhost:8080/api/v1/chat/2/summary
**